(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{CrPO:function(t,e,s){"use strict";s.r(e);var i=s("ofXK"),n=s("3Pt+"),r=s("tyNb"),o=s("fXoL"),c=s("442W"),a=s("EhPO");function u(t,e){if(1&t){const t=o.Wb();o.Vb(0,"button",2),o.hc("click",(function(e){return o.wc(t),o.kc().login()})),o.Gc(1,"Login "),o.Tb()}}function g(t,e){if(1&t){const t=o.Wb();o.Vb(0,"button",2),o.hc("click",(function(e){return o.wc(t),o.kc().logout()})),o.Gc(1,"Logout "),o.Tb()}}function h(t,e){if(1&t&&(o.Vb(0,"div"),o.Vb(1,"p"),o.Gc(2," Zapisano w local storage:"),o.Pb(3,"br"),o.Gc(4),o.Pb(5,"br"),o.Gc(6),o.Tb(),o.Tb()),2&t){const t=o.kc();o.Bb(4),o.Ic(" Session ID: ",t.temp.session_id||"nic",""),o.Bb(2),o.Ic(" Token: ",t.temp.fragment||"nic"," ")}}function b(t,e){1&t&&(o.Vb(0,"div"),o.Vb(1,"p"),o.Gc(2," Nic nie zapisano w local storage "),o.Tb(),o.Tb())}const p={session_id:void 0,fragment:void 0},l=[{path:"",component:(()=>{class t{constructor(t,e,s,i){this.authService=t,this.router=e,this.storage=s,this.route=i,this.setMessage(),this.temp=this.storage.getQueryParamsAndFragment()}setMessage(){this.message="Logged "+(this.authService.isLoggedIn?"in":"out")}login(){this.message="Trying to log in...",this.subscription=this.authService.login().subscribe(()=>{if(this.setMessage(),this.authService.isLoggedIn){const t=this.authService.redirectUrl?this.router.parseUrl(this.authService.redirectUrl).toString().split("?")[0]:"/crisis";console.log("LoginComponent # login() # redirect: "+t),this.router.navigate([...t.split("/")],{queryParamsHandling:"preserve",preserveFragment:!0})}}),this.temp=this.extractObj(),this.store(this.temp)}extractObj(){this.sessionIdd=this.route.snapshot.queryParams.session_id||null,this.tokenn=this.route.snapshot.fragment||null;const t=p;return t.session_id=this.sessionIdd,t.fragment=this.tokenn,t}store(t){this.storage.storeQueryParamsAndFragment(t),console.log("LoginComponent # store(temp): "+JSON.stringify(t))}logout(){this.authService.logout(),this.storage.clearLocalStorage(),this.setMessage(),this.router.navigate(["crisis"],{queryParamsHandling:"preserve",preserveFragment:!0}).then(()=>this.authService.redirectUrl=void 0)}setTemp(){this.temp=this.storage.getQueryParamsAndFragment()}ngOnInit(){this.setTemp()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.ɵfac=function(e){return new(e||t)(o.Ob(c.a),o.Ob(r.b),o.Ob(a.b),o.Ob(r.a))},t.ɵcmp=o.Ib({type:t,selectors:[["app-login"]],decls:9,vars:5,consts:[[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(o.Vb(0,"h2"),o.Gc(1," LOGIN\n"),o.Tb(),o.Vb(2,"p"),o.Gc(3),o.Tb(),o.Vb(4,"p"),o.Ec(5,u,2,0,"button",0),o.Ec(6,g,2,0,"button",0),o.Tb(),o.Ec(7,h,7,2,"div",1),o.Ec(8,b,3,0,"div",1)),2&t&&(o.Bb(3),o.Ic(" ",e.message,"\n"),o.Bb(2),o.pc("ngIf",!e.authService.isLoggedIn),o.Bb(1),o.pc("ngIf",e.authService.isLoggedIn),o.Bb(1),o.pc("ngIf",e.temp),o.Bb(1),o.pc("ngIf",!e.temp))},directives:[i.l],styles:[""]}),t})()}];let d=(()=>{class t{}return t.ɵmod=o.Mb({type:t}),t.ɵinj=o.Lb({factory:function(e){return new(e||t)},imports:[[r.e.forChild(l)],r.e]}),t})();s.d(e,"AuthModule",(function(){return m}));let m=(()=>{class t{}return t.ɵmod=o.Mb({type:t}),t.ɵinj=o.Lb({factory:function(e){return new(e||t)},imports:[[i.c,n.f,d]]}),t})()}}]);